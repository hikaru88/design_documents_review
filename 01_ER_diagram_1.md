# ER図1
## 全体
- 指摘事項

## テーブル名
- 指摘事項

# 注意
* マークダウン形式で記入してください。
* 全体を通しての指摘事項の場合、テーブル名の部分を「全体」「共通」などとしてください。


## 全体
- 1対〇〇の1の方のカーディナリティが不完全。（0以上なのか、1以上なのかの記載が無い）
- 更新日、作成日のカラムがない
- ディスク、曲、入荷テーブルがない。


## エンドユーザ
- 管理人idを持っている。（管理人とのリレーションは必要ない）
- カートとのリレーションが無い。
- 論理削除が考慮されていない（会員ステータスなどのカラム）


## 商品
- 管理人idを持っている。（管理人とのリレーションは必要ない）
- ディスクが複数あった場合に対応できない。
- 商品とカートのリレーションが間違っている。（商品とカートは1対0以上）
- 購入履歴とのリレーションが無い（購入履歴を表示するときに商品情報を取得できない。）
- アーティスト、ジャンル、レーベルは他のテーブルに分けた方がいい（他のテーブルに登録しておけば、誤字もなくなり、検索も正確になる）
- 論理削除用のカラムがない（商品ステータスなど。trueとfalseで削除されてるか判断する。）
- （入荷数 - 購買数）で計算できるため、在庫数カラムを持たなくていい。

## カート
- アーティスト名、ジャケット画像、シングル/アルバム名、合計金額は必要ない。
- テーブル名はエンドユーザーカートアイテム
- PKはカートアイテムid

## 決済
- 合計金額を保存するカラムが無い。
- 発送状況を保存するカラムが無い。（もし、購入履歴に発送ステータスカラムを持たせると商品ごとに発送ステータスを変更しなくてはならなくなる。）
- 決済とカートのリレーションは必要ない。
- 決済と購入履歴のリレーションが間違っている。（決済と購入履歴は1対1以上）
- 機能としては注文情報なので、テーブル名は注文などが適切。
- デフォルトで作成日、更新日を記録するカラムがあるので購入日カラムは不要。
- 送料カラムが必要
- 宛名、郵便番号カラムが必要
- 消費税カラムがあれば、消費税が変更されたときに便利。

## 購入履歴
- PKが無い。
- 購入された商品情報が確認できない。
- 購入された時の商品の価格が確認できない。
- 購入された商品の数が確認できない。
- 商品とのリレーションが無い。
- 管理者から見た場合、購入履歴というテーブル名は不自然。受注履歴やorder_detailが望ましい。



# フィードバック

## 全体
- 1対〇〇の1の方のカーディナリティが不完全。（0以上なのか、1以上なのかの記載が無い）
    - 正解です○

    - 全体に対してあと４つ指摘事項があるので、もう少し考えてみましょう！（わからなかったらきいてください）

## エンドユーザ
- 管理人idを持っている。（管理人とのリレーションは必要ない）
- カートとのリレーションが無い。
    - 正解です！○

    - もう１つ足りないのですが、論理削除についての問題点もあげてください！

## 商品
- 管理人idを持っている。（管理人とのリレーションは必要ない）
- ディスクが複数あった場合に対応できない。
    - 上記２つ正解です！
- 商品とカートのリレーションが間違っている。（商品とカートは1対0以上）
    - こちらは、商品が１に対して複数のカートがひもずくか
- 購入履歴とのリレーションが無い。
    - こちらはどうして必要だと思いましたか？

    - アーティスト、ジャンル、レーベルをカラムで持つべきか考えてみてください！
    - 曲が複数あった時に対応できないです。
    - 論理削除についての問題点もあげてください！
    - ステータスが何を意味してるのか明確にした方がいいです
    - 在庫数のカラムはもたない！

## カート
- アーティスト名、ジャケット画像、シングル/アルバム名、合計金額は必要ない。
    - 上記正解です！○

    - こちらテーブル名が違います
    - 合計金額は持たなくてもいいです
    - PKの命名がおかしいです

## 決済
- 合計金額を保存するカラムが無い。
- 決済とカートのリレーションは必要ない。
- 決済と購入履歴のリレーションが間違っている。（決済と購入履歴は1対1以上）
    - 上記正解です！

- 発送状況を保存するカラムが無い。
    - これは決済テーブルに必要なカラムですか？

    - テーブル名と機能が異なっている。
    - 購入日カラムを持っている。
    - 送料カラムがない
    - 送付先住所カラムがあるが、宛名と郵便番号がない。

## 購入履歴
- PKが無い。
- 購入された商品情報が確認できない。
- 購入された時の商品の価格が確認できない。
- 購入された商品の数が確認できない。
    - 上記正解です○

    - 商品とリレーション駿河言えたらよりよかったと思います！


# フィードバック2回目
[add]→付け加えなければいけないところ
[fix]→修正が必要なところ
[comment]→その他コメント

## 商品
- 購入履歴とのリレーションが無い（購入履歴から商品の情報を持ってこれない）
[comment]→細かいですが、商品から注文詳細情報を取得するという関係性になると思います。
- 商品のステータスでは無いため在庫数のカラムは持たない。
[fix]→在校数カラムを持たなくてもいい理由は、（入荷数）ー（購買数）で簡単に計算できる数値なので、わざわざデータベースにしまうような値ではないからです。計算後の値はデータベースに入れない方がいいです。計算処理が同時に行われた際、エラーが起きる可能性があるからです。

## 決済
[comment]→修正ではないですが、「消費税カラム」があってもいいかもです。消費税、時折変わるので、データベース上で値を変更できると楽なためです。必須じゃないですが、、

## 購入履歴
[add]→機能としては注文の詳細なので、テーブル名は注文詳細（order_details）などが適切。基本的にテーブルの命名は「管理者の視点」で行うためです。

# フィードバック3回目
[add]→付け加えなければいけないところ
[fix]→修正が必要なところ
[comment]→その他コメント

## 全体
- [add]Railsで自動で生成されるカラムについて言及がされていません。

## カート
- [add]現状ですと、誰のカートなのかがわかりません。

# フィードバック4回目
[add]→付け加えなければいけないところ
[fix]→修正が必要なところ
[comment]→その他コメント

## カート
- "テーブル名はエンドユーザーカートアイテム" の抽出がありますが、"カートアイテム"で大丈夫です。
- 抽出するとすれば欲しいのは、カートテーブルに会員idのfkがないことです。
    - ただエンドユーザーテーブルでもカートとのリレーションがないことを指摘しているので、なくても大丈夫。
