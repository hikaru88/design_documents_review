# ER図1
## 全体
- 指摘事項

## テーブル名
- 指摘事項

# 注意
* マークダウン形式で記入してください。
* 全体を通しての指摘事項の場合、テーブル名の部分を「全体」「共通」などとしてください。


## 全体
- 1対〇〇の1の方のカーディナリティが不完全。（0以上なのか、1以上なのかの記載が無い）
  > 全体的にカーディナリティが不完全です。1対〇〇の1の方のカーディナリティを0以上なのか、1以上なのかわかるようにしてください。

- 更新日、作成日のカラムがない
  > ActiveRecordでデフォルトで作られる登録日、更新日の記述もお願いいたします。もし持たないのであれば理由を教えてください。

- ディスク、曲、入荷テーブルがない。
  > 1つの商品に対して、複数のディスク、曲を登録したい場合はどうしますか？現状だと、1つの商品には1枚のディスクと曲しか登録できません。
  > 商品の入荷はどのように行いますか？また、入荷履歴はどこで確認しますか？


## エンドユーザ
- 管理人idを持っている。（管理人とのリレーションは必要ない）
  > エンドユーザと管理人のリレーションは必要ですか？必要なら理由を教えてください。

- カートとのリレーションが無い。
  > カートとのリレーションがありませんが、購入時のユーザーの判断はどのように行いますか？

- 論理削除が考慮されていない（会員ステータスなどのカラム）
  > ユーザーは通常の削除は行わず、論理削除をします。論理削除用のカラムの追加をお願いします。


## 商品
- 管理人idを持っている。（管理人とのリレーションは必要ない）
  > 商品と管理人のリレーションは必要ですか？必要なら理由を教えてください。

- ディスクが複数あった場合に対応できない。
  > 1つの商品に対して複数のディスクを登録したい場合はどうしますか？

- 商品とカートのリレーションが間違っている。（商品とカートは1対0以上）
  > 現在のカーディナリティだと、カートは商品idを持つことが必須になっていますが大丈夫ですか？

- 購入履歴とのリレーションが無い（購入履歴を表示するときに商品情報を取得できない。）
  > 購入履歴とのリレーションがありませんが、購入履歴はどのように商品の情報を取得しますか？

- アーティスト、ジャンル、レーベルは他のテーブルに分けた方がいい（他のテーブルに登録しておけば、誤字もなくなり、検索も正確になる）
  > 商品登録時に毎回アーティスト名を入力する必要があると、アーティスト名で検索するときに誤字やアルファベットの大文字小文字の違いなどで検索結果が変わってしまうのでアーティストテーブルを作成してください。
  > 商品登録時に毎回ジャンル名を入力する必要があると、ジャンル名で検索するときに誤字やアルファベットの大文字小文字の違いなどで検索結果が変わってしまうのでジャンルテーブルを作成してください。
  > 商品登録時に毎回レーベル名を入力する必要があると、レーベル名で検索するときに誤字やアルファベットの大文字小文字の違いなどで検索結果が変わってしまうのでレーベルテーブルを作成してください。

- 論理削除用のカラムがない（商品ステータスなど。trueとfalseで削除されてるか判断する。）
  > 商品は通常の削除は行わず、論理削除をします。論理削除用のカラムの追加をお願いします。

- （入荷数 - 購買数）で計算できるため、在庫数カラムを持たなくていい。
  > 在庫数は(入荷数 - 購買数)で計算できるため、在庫数カラムは必要ありません。

## カート
- アーティスト名、ジャケット画像、シングル/アルバム名、合計金額は必要ない。
  > カートにアーティスト名カラムは必要ですか？必要なら理由を教えてください。
  > カートにジャケット画像カラムは必要ですか？必要なら理由を教えてください。
  > カートにシングル/アルバム名カラムは必要ですか？必要なら理由を教えてください。
  > カートに合計金額カラムは必要ですか？必要なら理由を教えてください。

- テーブル名はカートアイテム
  > 現在のカートテーブルには商品と商品の個数が保存されます。そのため、テーブル名はカートアイテムが適切です。

- PKはカートアイテムid
  > PKは注文idではありません。カートアイテムidになります。

## 決済
- 合計金額を保存するカラムが無い。
  > 合計金額はどこで確認しますか？

- 発送状況を保存するカラムが無い。（もし、購入履歴に発送ステータスカラムを持たせると商品ごとに発送ステータスを変更しなくてはならなくなる。）
  > 発送状況はどこで管理しますか？

- 決済とカートのリレーションは必要ない。
  > 決済とカートにリレーションがあります。この場合、購入後にもカートの情報は残すということでいいですか？

- 決済と購入履歴のリレーションが間違っている。（決済と購入履歴は1対1以上）
  > 決済と購入履歴のカーディナリティが1対0以上になっています。この場合、購入履歴の無い決済が存在してしまいますが大丈夫ですか？

- 機能としては注文情報なので、テーブル名は注文などが適切。
  > 保存する情報は注文情報なので、テーブル名は注文が適切です。

- デフォルトで作成日、更新日を記録するカラムがあるので購入日カラムは不要。
  > 作成日カラムがあるので、購入日カラムは必要ないです。

- 送料カラムが必要
  > 送料はどこで管理しますか？

- 宛名、郵便番号カラムが必要
  > 宛名、郵便番号はどこで管理しますか？

- 消費税カラムがあれば、消費税が変更されたときに便利。
  > 消費税カラムがあれば、消費税が変更されたときに便利です。必須ではないです。

## 購入履歴
- PKが無い。
  > PKがないです。

- 商品とのリレーションが無いので購入された商品情報が確認できない。
  > 商品とのリレーションがありませんが、どのように商品情報を取得しますか？

- 購入された時の商品の価格が確認できない。
  > 購入後に商品の価格が変更された場合、購入履歴から購入時の商品価格が確認できません。商品価格を保存するカラムを追加してください。

- 購入された商品の数が確認できない。
  > 商品が幾つ購入されたか確認できません。購入された商品の数量を保存するカラムを追加してください。

- 管理者から見た場合、購入履歴というテーブル名は不自然。受注履歴やorder_detailが望ましい。
  > テーブル名などの命名は基本的に管理者の視点で行うため、購入履歴というテーブル名は不自然です。受注履歴などに変更してください。



# フィードバック

## 全体
- 1対〇〇の1の方のカーディナリティが不完全。（0以上なのか、1以上なのかの記載が無い）
    - 正解です○

    - 全体に対してあと４つ指摘事項があるので、もう少し考えてみましょう！（わからなかったらきいてください）

## エンドユーザ
- 管理人idを持っている。（管理人とのリレーションは必要ない）
- カートとのリレーションが無い。
    - 正解です！○

    - もう１つ足りないのですが、論理削除についての問題点もあげてください！

## 商品
- 管理人idを持っている。（管理人とのリレーションは必要ない）
- ディスクが複数あった場合に対応できない。
    - 上記２つ正解です！
- 商品とカートのリレーションが間違っている。（商品とカートは1対0以上）
    - こちらは、商品が１に対して複数のカートがひもずくか
- 購入履歴とのリレーションが無い。
    - こちらはどうして必要だと思いましたか？

    - アーティスト、ジャンル、レーベルをカラムで持つべきか考えてみてください！
    - 曲が複数あった時に対応できないです。
    - 論理削除についての問題点もあげてください！
    - ステータスが何を意味してるのか明確にした方がいいです
    - 在庫数のカラムはもたない！

## カート
- アーティスト名、ジャケット画像、シングル/アルバム名、合計金額は必要ない。
    - 上記正解です！○

    - こちらテーブル名が違います
    - 合計金額は持たなくてもいいです
    - PKの命名がおかしいです

## 決済
- 合計金額を保存するカラムが無い。
- 決済とカートのリレーションは必要ない。
- 決済と購入履歴のリレーションが間違っている。（決済と購入履歴は1対1以上）
    - 上記正解です！

- 発送状況を保存するカラムが無い。
    - これは決済テーブルに必要なカラムですか？

    - テーブル名と機能が異なっている。
    - 購入日カラムを持っている。
    - 送料カラムがない
    - 送付先住所カラムがあるが、宛名と郵便番号がない。

## 購入履歴
- PKが無い。
- 購入された商品情報が確認できない。
- 購入された時の商品の価格が確認できない。
- 購入された商品の数が確認できない。
    - 上記正解です○

    - 商品とリレーション駿河言えたらよりよかったと思います！


# フィードバック2回目
[add]→付け加えなければいけないところ
[fix]→修正が必要なところ
[comment]→その他コメント

## 商品
- 購入履歴とのリレーションが無い（購入履歴から商品の情報を持ってこれない）
[comment]→細かいですが、商品から注文詳細情報を取得するという関係性になると思います。
- 商品のステータスでは無いため在庫数のカラムは持たない。
[fix]→在校数カラムを持たなくてもいい理由は、（入荷数）ー（購買数）で簡単に計算できる数値なので、わざわざデータベースにしまうような値ではないからです。計算後の値はデータベースに入れない方がいいです。計算処理が同時に行われた際、エラーが起きる可能性があるからです。

## 決済
[comment]→修正ではないですが、「消費税カラム」があってもいいかもです。消費税、時折変わるので、データベース上で値を変更できると楽なためです。必須じゃないですが、、

## 購入履歴
[add]→機能としては注文の詳細なので、テーブル名は注文詳細（order_details）などが適切。基本的にテーブルの命名は「管理者の視点」で行うためです。

# フィードバック3回目
[add]→付け加えなければいけないところ
[fix]→修正が必要なところ
[comment]→その他コメント

## 全体
- [add]Railsで自動で生成されるカラムについて言及がされていません。

## カート
- [add]現状ですと、誰のカートなのかがわかりません。

# フィードバック4回目
[add]→付け加えなければいけないところ
[fix]→修正が必要なところ
[comment]→その他コメント

## カート
- "テーブル名はエンドユーザーカートアイテム" の抽出がありますが、"カートアイテム"で大丈夫です。
- 抽出するとすれば欲しいのは、カートテーブルに会員idのfkがないことです。
    - ただエンドユーザーテーブルでもカートとのリレーションがないことを指摘しているので、なくても大丈夫。
